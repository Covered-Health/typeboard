<div class="mb-3">
    {% if field.widget == "textarea" %}
    <label class="form-label" for="field-{{ field.name }}">{{ field.label }}</label>
    <textarea class="form-control" id="field-{{ field.name }}"
              name="{{ field.name }}"
              {% if field.read_only %}disabled{% endif %}
              {% if field.required %}required{% endif %}
              placeholder="Enter {{ field.label | lower }}..."
              rows="4">{{ values.get(field.name, field.default or '') }}</textarea>

    {% elif field.widget == "checkbox" %}
    <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" role="switch"
               id="field-{{ field.name }}" name="{{ field.name }}"
               {% if values.get(field.name, field.default) %}checked{% endif %}
               {% if field.read_only %}disabled{% endif %}>
        <label class="form-check-label" for="field-{{ field.name }}">{{ field.label }}</label>
    </div>

    {% elif field.widget == "number" %}
    <label class="form-label" for="field-{{ field.name }}">{{ field.label }}</label>
    <input type="number" class="form-control" id="field-{{ field.name }}"
           name="{{ field.name }}" value="{{ values.get(field.name, field.default or '') }}"
           {% if field.read_only %}disabled{% endif %} {% if field.required %}required{% endif %}
           placeholder="0">

    {% elif field.widget == "date" %}
    <label class="form-label" for="field-{{ field.name }}">{{ field.label }}</label>
    <input type="date" class="form-control" id="field-{{ field.name }}"
           name="{{ field.name }}" value="{{ values.get(field.name, field.default or '') }}"
           {% if field.read_only %}disabled{% endif %} {% if field.required %}required{% endif %}>

    {% elif field.widget == "datetime" %}
    <label class="form-label" for="field-{{ field.name }}">{{ field.label }}</label>
    <input type="datetime-local" class="form-control" id="field-{{ field.name }}"
           name="{{ field.name }}" value="{{ values.get(field.name, field.default or '') }}"
           {% if field.read_only %}disabled{% endif %} {% if field.required %}required{% endif %}>

    {% elif field.widget == "multiselect" and field.relationship %}
    {% set current = values.get(field.name, []) | map('string') | list %}
    {% set select_id = "rel-" ~ field.name %}
    <label class="form-label" for="{{ select_id }}">{{ field.label }}</label>
    <select class="form-select" id="{{ select_id }}"
            name="{{ field.name }}" multiple
            {% if field.read_only %}disabled{% endif %}
            data-ts-remote="{{ base_path }}/{{ resource.id }}/options/{{ field.name }}">
        {% for value, label in field.enum_choices or [] %}
        <option value="{{ value }}" {% if value|string in current %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
    </select>

    {% elif field.widget == "multiselect" %}
    {% set current = values.get(field.name, []) | map('string') | list %}
    {% set select_id = "ms-" ~ field.name %}
    <label class="form-label" for="{{ select_id }}">{{ field.label }}</label>
    <select class="form-select" id="{{ select_id }}"
            name="{{ field.name }}" multiple
            {% if field.read_only %}disabled{% endif %}
            data-ts="true">
        {% if field.enum_choices %}
        {% for value, label in field.enum_choices %}
        <option value="{{ value }}" {% if value|string in current %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
        {% endif %}
    </select>

    {% elif field.widget == "select" %}
    <label class="form-label" for="field-{{ field.name }}">{{ field.label }}</label>
    <select class="form-select" id="field-{{ field.name }}"
            name="{{ field.name }}"
            {% if field.read_only %}disabled{% endif %} {% if field.required %}required{% endif %}>
        {% if not field.required %}<option value="">Select...</option>{% endif %}
        {% if field.enum_choices %}
        {% for value, label in field.enum_choices %}
        <option value="{{ value }}" {% if values.get(field.name) == value %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
        {% endif %}
    </select>

    {% else %}
    <label class="form-label" for="field-{{ field.name }}">{{ field.label }}</label>
    <input type="text" class="form-control" id="field-{{ field.name }}"
           name="{{ field.name }}" value="{{ values.get(field.name, field.default or '') }}"
           {% if field.read_only %}disabled{% endif %} {% if field.required %}required{% endif %}
           placeholder="Enter {{ field.label | lower }}...">
    {% endif %}
</div>
